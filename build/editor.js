(()=>{"use strict";var e={n:t=>{var s=t&&t.__esModule?()=>t.default:()=>t;return e.d(s,{a:s}),s},d:(t,s)=>{for(var r in s)e.o(s,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:s[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.React,s=window.wp.plugins,r=window.wp.editor,n=window.wp.components,l=window.wp.element,a=window.wp.data,i=window.wp.apiFetch;var o=e.n(i);const c=window.wp.i18n,u=()=>{const[e,s]=(0,l.useState)(!1),[r,i]=(0,l.useState)(null),[u,g]=(0,l.useState)(null),{postId:d}=(0,a.useSelect)(e=>({postId:e("core/editor").getCurrentPostId()}),[]),m=r?.issues?.reduce((e,t)=>{const s=t.severity||"suggestion";return e[s]||(e[s]=[]),e[s].push(t),e},{});return(0,t.createElement)(n.PanelBody,null,(0,t.createElement)(n.Button,{variant:"primary",onClick:async()=>{s(!0),i(null),g(null);try{const e=await o()({path:"/sgr-poc/v1/review",method:"POST",data:{postId:d}});i(e)}catch(e){g(e.message||(0,c.__)("An unknown error occurred.","sgr-poc"))}finally{s(!1)}},disabled:e,isBusy:e},(0,c.__)("Review against Style Guide","sgr-poc")),u&&(0,t.createElement)(n.Notice,{status:"error",isDismissible:!0,onRemove:()=>g(null)},u),r&&(0,t.createElement)("div",{className:"sgr-results"},(0,t.createElement)("div",{className:`sgr-verdict sgr-verdict--${r.verdict}`},(0,c.__)("Verdict:","sgr-poc")," ",r.verdict.replace("_"," ")),r.issues&&0===r.issues.length&&(0,t.createElement)("p",null,(0,c.__)("No issues found. Great job!","sgr-poc")),m&&["critical","major","minor","suggestion"].map(e=>m[e]&&(0,t.createElement)("div",{key:e,className:`sgr-issue-group sgr-issue-group--${e}`},(0,t.createElement)("h3",{className:"sgr-issue-group__title"},e," (",m[e].length,")"),(0,t.createElement)("ul",null,m[e].map((e,s)=>(0,t.createElement)("li",{key:s,className:"sgr-issue"},(0,t.createElement)("strong",{className:"sgr-issue__rule-id"},e.ruleId),(0,t.createElement)("p",null,e.message),(0,t.createElement)("blockquote",{className:"sgr-issue__offending-text"},e.offendingText),e.suggestion&&(0,t.createElement)("div",{className:"sgr-issue__suggestion"},(0,t.createElement)("strong",null,(0,c.__)("Suggestion:","sgr-poc")),(0,t.createElement)("p",null,e.suggestion)))))))))};(0,s.registerPlugin)("sgr-poc",{render:()=>(0,t.createElement)(r.PluginSidebar,{name:"sgr-poc-sidebar",title:(0,c.__)("Style Guide Reviewer","sgr-poc"),icon:"text-page"},(0,t.createElement)(u,null))})})();